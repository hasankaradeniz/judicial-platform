{% extends "core/base.html" %}
{% load static %}

{% block page_title %}Yargƒ± Kararlarƒ± - Lexatech{% endblock %}

{% block extra_styles %}
<style>
    :root {
        --primary: #1e3a8a;
        --primary-light: #3b82f6;
        --secondary: #f59e0b;
        --gray-50: #f9fafb;
        --gray-100: #f3f4f6;
        --gray-200: #e5e7eb;
        --gray-300: #d1d5db;
        --gray-400: #9ca3af;
        --gray-500: #6b7280;
        --gray-600: #4b5563;
        --gray-700: #374151;
        --gray-800: #1f2937;
        --shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
        --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
    }
    
    body {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif !important; -apple-system, BlinkMacSystemFont, sans-serif;
        min-height: 100vh !important;
    }
    
    /* Header */
    .page-header {
        background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
        color: white;
        padding: 3rem 0;
        margin-bottom: -2rem;
        position: relative;
        overflow: hidden;
    }
    
    .page-header::before {
        content: '';
        position: absolute;
        top: 0; left: 0; right: 0; bottom: 0;
        background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.05'%3E%3Ccircle cx='30' cy='30' r='2'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
    }
    
    .header-content {
        max-width: 1200px;
        margin: 0 auto !important;
        padding: 0 1rem !important;
        position: relative;
        z-index: 1;
    }
    
    .header-title {
        font-size: 2.8rem;
        font-weight: 800;
        margin-bottom: 0.5rem;
        text-shadow: 0 2px 4px rgba(0,0,0,0.3);
    }
    
    .header-subtitle {
        font-size: 1.1rem;
        opacity: 0.9;
        font-weight: 300;
    }
    
    /* Search Card */
    .search-section {
        max-width: 1200px;
        margin: 0 auto !important;
        padding: 0 1rem !important;
        position: relative;
        z-index: 10;
    }
    
    .search-card {
        background: white;
        border-radius: 16px;
        box-shadow: 0 15px 35px rgba(0,0,0,0.1);
        padding: 2.5rem;
        margin-bottom: 2rem;
        backdrop-filter: blur(10px);
    }
    
    .search-title {
        font-size: 1.6rem;
        font-weight: 700;
        color: var(--gray-800);
        margin-bottom: 1.8rem;
        text-align: center;
    }
    
    .search-form {
        display: grid;
        gap: 1.5rem;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    }
    
    .form-group {
        display: flex;
        flex-direction: column;
    }
    
    .form-group.full-width {
        grid-column: 1 / -1;
    }
    
    .form-group label {
        font-size: 0.95rem;
        font-weight: 600;
        color: var(--gray-700);
        margin-bottom: 0.6rem;
    }
    
    .form-control {
        padding: 1rem 1.1rem;
        border: 2px solid var(--gray-300);
        border-radius: 10px;
        font-size: 1rem;
        line-height: 1.5;
        transition: all 0.2s ease;
        min-height: 48px;
        background: white;
    }
    
    .form-control:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 3px rgba(30, 58, 138, 0.1);
        transform: translateY(-1px);
    }
    
    .search-input-group {
        position: relative;
    }
    
    .search-input {
        padding-left: 3.5rem;
        font-weight: 500;
    }
    
    .search-icon {
        position: absolute;
        left: 1.2rem;
        top: 50%;
        transform: translateY(-50%);
        color: var(--gray-400);
        font-size: 1.1rem;
    }
    
    .btn-group {
        grid-column: 1 / -1;
        display: flex;
        gap: 1.2rem;
        justify-content: center;
        margin-top: 1.2rem;
    }
    
    .btn {
        padding: 1rem 2.2rem;
        border: none;
        border-radius: 10px;
        font-weight: 600;
        font-size: 1rem;
        cursor: pointer;
        transition: all 0.2s ease;
        min-width: 140px;
    }
    
    .btn-primary {
        background: var(--primary);
        color: white;
    }
    
    .btn-primary:hover {
        background: var(--primary-light);
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(30, 58, 138, 0.25);
    }
    
    .btn-secondary {
        background: var(--gray-200);
        color: var(--gray-700);
    }
    
    .btn-secondary:hover {
        background: var(--gray-300);
        transform: translateY(-1px);
    }
    
    /* Results */
    .results-section {
        max-width: 1200px;
        margin: 0 auto !important;
        padding: 0 1rem 2rem;
    }
    
    .results-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
        padding: 1.2rem;
        background: white;
        border-radius: 12px;
        box-shadow: var(--shadow);
    }
    
    .results-count {
        font-weight: 700;
        color: var(--primary);
        font-size: 1.3rem;
    }
    
    .results-info {
        font-size: 0.9rem;
        color: var(--gray-600);
    }
    
    .results-grid {
        display: grid;
        gap: 1.5rem;
    }
    
    .result-card {
        background: white;
        border-radius: 14px;
        box-shadow: var(--shadow);
        padding: 1.8rem;
        transition: all 0.2s ease;
        border: 1px solid var(--gray-200);
    }
    
    .result-card:hover {
        box-shadow: 0 12px 30px rgba(0,0,0,0.1);
        transform: translateY(-3px);
        border-color: var(--primary);
    }
    
    .result-header {
        display: flex;
        justify-content: space-between;
        align-items: start;
        margin-bottom: 0.8rem;
    }
    
    .court-badge {
        display: inline-flex;
        align-items: center;
        padding: 0.4rem 0.9rem;
        background: var(--gray-100);
        color: var(--gray-700);
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.3px;
    }
    
    .court-badge.yargitay { background: #fef3c7; color: #92400e; }
    .court-badge.danistay { background: #dbeafe; color: #1e40af; }
    .court-badge.anayasa { background: #fce7f3; color: #9f1239; }
    .court-badge.sayistay { background: #d1fae5; color: #065f46; }
    
    .result-date {
        font-size: 0.9rem;
        color: var(--gray-500);
        font-weight: 600;
    }
    
    .result-title {
        font-weight: 700;
        color: var(--gray-800);
        margin-bottom: 0.6rem;
        font-size: 1.1rem;
        line-height: 1.4;
    }
    
    .result-numbers {
        display: flex;
        gap: 1.2rem;
        font-size: 0.9rem;
        color: var(--gray-600);
        margin-bottom: 0.8rem;
        font-weight: 500;
    }
    
    .result-summary {
        color: var(--gray-700);
        line-height: 1.6;
        margin-bottom: 1.2rem;
        font-size: 0.95rem;
    }
    
    .result-link {
        color: var(--primary);
        text-decoration: none;
        font-weight: 600;
        font-size: 0.9rem;
        display: inline-flex;
        align-items: center;
        gap: 0.4rem;
    }
    
    .result-link:hover {
        color: var(--primary-light);
        text-decoration: underline;
    }
    
    /* Pagination */
    .pagination-container {
        display: flex;
        justify-content: center;
        margin-top: 3rem;
    }
    
    .pagination {
        display: flex;
        gap: 0.5rem;
        align-items: center;
        background: white;
        padding: 1rem;
        border-radius: 12px;
        box-shadow: var(--shadow);
    }
    
    .page-link {
        padding: 0.7rem 1rem;
        min-width: 45px;
        text-align: center;
        border: 2px solid var(--gray-300);
        border-radius: 8px;
        color: var(--gray-700);
        text-decoration: none;
        transition: all 0.2s;
        font-weight: 600;
    }
    
    .page-link:hover {
        background: var(--gray-100);
        border-color: var(--primary);
        color: var(--primary);
        transform: translateY(-1px);
    }
    
    .page-link.active {
        background: var(--primary);
        color: white;
        border-color: var(--primary);
    }
    
    .page-link.disabled {
        opacity: 0.5;
        cursor: not-allowed;
    }
    
    /* Loading */
    .loading-overlay {
        position: fixed;
        top: 0; left: 0; right: 0; bottom: 0;
        background: rgba(0, 0, 0, 0.6);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 9999;
    }
    
    .loading-spinner {
        background: white;
        padding: 2.5rem;
        border-radius: 16px;
        text-align: center;
        box-shadow: 0 15px 35px rgba(0,0,0,0.2);
    }
    
    .spinner {
        border: 4px solid var(--gray-200);
        border-top-color: var(--primary);
        border-radius: 50%;
        width: 45px;
        height: 45px;
        animation: spin 1s linear infinite;
        margin: 0 auto 1.2rem;
    }
    
    @keyframes spin {
        to { transform: rotate(360deg); }
    }
    
    /* Alert */
    .alert {
        padding: 1.2rem;
        border-radius: 10px;
        margin-bottom: 1.2rem;
    }
    
    .alert-warning {
        background: #fef3c7;
        color: #92400e;
        border: 2px solid #fcd34d;
    }
    
    /* Empty State */
    .empty-state {
        text-align: center;
        padding: 3.5rem;
        background: white;
        border-radius: 16px;
        box-shadow: var(--shadow);
    }
    
    .empty-icon {
        font-size: 3.5rem;
        color: var(--gray-400);
        margin-bottom: 1.5rem;
    }
    
    .empty-title {
        font-size: 1.4rem;
        font-weight: 700;
        color: var(--gray-700);
        margin-bottom: 0.8rem;
    }
    
    .empty-text {
        color: var(--gray-600);
        font-size: 1rem;
        line-height: 1.6;
    }
    
    /* Responsive */
    @media (max-width: 768px) {
        .header-title { font-size: 2.2rem; }
        .search-card { padding: 2rem; }
        .search-form { grid-template-columns: 1fr; }
        .btn-group { flex-direction: column; }
        .results-header { flex-direction: column; align-items: start; gap: 1rem; }
        .result-numbers { flex-direction: column; gap: 0.5rem; }
    }
</style>
{% endblock %}

{% block content %}
<div class="page-header">
    <div class="header-content">
        <h1 class="header-title">Yargƒ± Kararlarƒ±</h1>
        <p class="header-subtitle">Hukuki kararlarƒ± arayƒ±n ve inceleyin</p>
    </div>
</div>

<div class="search-section">
    <div class="search-card">
        <h2 class="search-title">üîç MODERN ARAMA - 17:56</h2>
        <form method="get" action="{% url 'judicial_decisions' %}" id="searchForm">
            <div class="search-form">
                <div class="form-group full-width">
                    <label for="q">Arama Terimi (Opsiyonel)</label>
                    <div class="search-input-group">
                        <i class="fas fa-search search-icon"></i>
                        <input type="text" 
                               name="q" 
                               id="q"
                               class="form-control search-input" 
                               placeholder="Karar metni, anahtar kelime... (√∂rn: kƒ±dem tazminatƒ±)"
                               value="{{ query }}">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="court_type">Mahkeme T√ºr√º</label>
                    <select name="court_type" id="court_type" class="form-control">
                        <option value="">T√ºm√º</option>
                        {% for stat in court_type_stats %}
                        <option value="{{ stat.karar_turu }}" 
                                {% if court_type == stat.karar_turu %}selected{% endif %}>
                            {{ stat.karar_turu }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="chamber">Daire</label>
                    <select name="chamber" id="chamber" class="form-control">
                        <option value="">T√ºm√º</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="decision_number">Karar Numarasƒ±</label>
                    <input type="text" 
                           name="decision_number" 
                           id="decision_number" 
                           class="form-control" 
                           placeholder="√ñrn: 2021/1234"
                           value="{{ decision_number }}">
                </div>
                
                <div class="form-group">
                    <label for="case_number">Esas Numarasƒ±</label>
                    <input type="text" 
                           name="case_number" 
                           id="case_number" 
                           class="form-control" 
                           placeholder="√ñrn: 2021/5678"
                           value="{{ case_number }}">
                </div>
                
                <div class="form-group">
                    <label for="date_range">Tarih Aralƒ±ƒüƒ±</label>
                    <select name="date_range" id="date_range" class="form-control">
                        <option value="">T√ºm Zamanlar</option>
                        <option value="today" {% if date_range == 'today' %}selected{% endif %}>Bug√ºn</option>
                        <option value="week" {% if date_range == 'week' %}selected{% endif %}>Son 1 Hafta</option>
                        <option value="month" {% if date_range == 'month' %}selected{% endif %}>Son 1 Ay</option>
                        <option value="3months" {% if date_range == '3months' %}selected{% endif %}>Son 3 Ay</option>
                        <option value="6months" {% if date_range == '6months' %}selected{% endif %}>Son 6 Ay</option>
                        <option value="year" {% if date_range == 'year' %}selected{% endif %}>Son 1 Yƒ±l</option>
                    </select>
                </div>
                
                <div class="btn-group">
                    <button type="button" class="btn btn-secondary" onclick="clearFilters()">
                        <i class="fas fa-times"></i> Temizle
                    </button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-search"></i> Ara
                    </button>
                </div>
            </div>
        </form>
    </div>
</div>

<div class="results-section">
    {% if decisions.object_list %}
        <div class="results-header">
            <div>
                <span class="results-count">{{ total_count|floatformat:0 }}</span> sonu√ß bulundu
                {% if search_time %}
                    <span class="results-info">({{ search_time }} ms)</span>
                {% endif %}
            </div>
            {% if limited %}
                <div class="alert alert-warning">
                    <i class="fas fa-info-circle"></i> 
                    √áok fazla sonu√ß bulundu. ƒ∞lk 3000 sonu√ß g√∂steriliyor.
                </div>
            {% endif %}
        </div>
        
        <div class="results-grid">
            {% for decision in decisions %}
            <div class="result-card">
                <div class="result-header">
                    <span class="court-badge {{ decision.karar_turu|lower }}">
                        {{ decision.karar_turu }}
                    </span>
                    {% if decision.karar_tarihi %}
                    <span class="result-date">
                        {{ decision.karar_tarihi|date:"d.m.Y" }}
                    </span>
                    {% endif %}
                </div>
                
                <h3 class="result-title">{{ decision.karar_veren_mahkeme }}</h3>
                
                <div class="result-numbers">
                    {% if decision.esas_numarasi %}
                    <span><strong>Esas:</strong> {{ decision.esas_numarasi }}</span>
                    {% endif %}
                    {% if decision.karar_numarasi %}
                    <span><strong>Karar:</strong> {{ decision.karar_numarasi }}</span>
                    {% endif %}
                </div>
                
                {% if decision.karar_ozeti %}
                <p class="result-summary">{{ decision.karar_ozeti|truncatewords:35 }}</p>
                {% endif %}
                
                <a href="{% url 'judicial_detail' decision.id %}" class="result-link">
                    Detaylarƒ± G√∂r√ºnt√ºle <i class="fas fa-arrow-right"></i>
                </a>
            </div>
            {% endfor %}
        </div>
        
        {% if decisions.has_other_pages %}
        <div class="pagination-container">
            <div class="pagination">
                {% if decisions.has_previous %}
                    <a href="?q={{ query }}&court_type={{ court_type }}&chamber={{ chamber }}&date_range={{ date_range }}&decision_number={{ decision_number }}&case_number={{ case_number }}&page={{ decisions.previous_page_number }}" class="page-link">
                        <i class="fas fa-chevron-left"></i>
                    </a>
                {% endif %}
                
                {% for num in page_range %}
                    {% if num == decisions.number %}
                        <span class="page-link active">{{ num }}</span>
                    {% elif num == '...' %}
                        <span class="page-link disabled">...</span>
                    {% else %}
                        <a href="?q={{ query }}&court_type={{ court_type }}&chamber={{ chamber }}&date_range={{ date_range }}&decision_number={{ decision_number }}&case_number={{ case_number }}&page={{ num }}" class="page-link">{{ num }}</a>
                    {% endif %}
                {% endfor %}
                
                {% if decisions.has_next %}
                    <a href="?q={{ query }}&court_type={{ court_type }}&chamber={{ chamber }}&date_range={{ date_range }}&decision_number={{ decision_number }}&case_number={{ case_number }}&page={{ decisions.next_page_number }}" class="page-link">
                        <i class="fas fa-chevron-right"></i>
                    </a>
                {% endif %}
            </div>
        </div>
        {% endif %}
    {% else %}
        <div class="empty-state">
            <i class="fas fa-search empty-icon"></i>
            <h3 class="empty-title">
                {% if query or court_type or chamber or date_range or decision_number or case_number %}
                    Sonu√ß bulunamadƒ±
                {% else %}
                    Arama yapƒ±n
                {% endif %}
            </h3>
            <p class="empty-text">
                {% if query or court_type or chamber or date_range or decision_number or case_number %}
                    Farklƒ± kriterlerle tekrar deneyin
                {% else %}
                    Yukarƒ±daki formu kullanarak yargƒ± kararlarƒ±nƒ± arayabilirsiniz
                {% endif %}
            </p>
        </div>
    {% endif %}
</div>

<div class="loading-overlay" id="loadingOverlay">
    <div class="loading-spinner">
        <div class="spinner"></div>
        <p style="font-weight: 600; font-size: 1.1rem;">Arama yapƒ±lƒ±yor...</p>
    </div>
</div>

<script>
const chamberData = {
    'YARGITAY': [
        '1. Hukuk Dairesi', '2. Hukuk Dairesi', '3. Hukuk Dairesi', '4. Hukuk Dairesi',
        '5. Hukuk Dairesi', '6. Hukuk Dairesi', '7. Hukuk Dairesi', '8. Hukuk Dairesi',
        '9. Hukuk Dairesi', '10. Hukuk Dairesi', '11. Hukuk Dairesi', '12. Hukuk Dairesi',
        '13. Hukuk Dairesi', '14. Hukuk Dairesi', '15. Hukuk Dairesi', '16. Hukuk Dairesi',
        '17. Hukuk Dairesi', '18. Hukuk Dairesi', '19. Hukuk Dairesi', '20. Hukuk Dairesi',
        '21. Hukuk Dairesi', '22. Hukuk Dairesi', '23. Hukuk Dairesi',
        '1. Ceza Dairesi', '2. Ceza Dairesi', '3. Ceza Dairesi', '4. Ceza Dairesi',
        '5. Ceza Dairesi', '6. Ceza Dairesi', '7. Ceza Dairesi', '8. Ceza Dairesi',
        '9. Ceza Dairesi', '10. Ceza Dairesi', '11. Ceza Dairesi', '12. Ceza Dairesi',
        '13. Ceza Dairesi', '14. Ceza Dairesi', '15. Ceza Dairesi', '16. Ceza Dairesi'
    ],
    'DANISTAY': [
        '1. Daire', '2. Daire', '3. Daire', '4. Daire', '5. Daire',
        '6. Daire', '7. Daire', '8. Daire', '9. Daire', '10. Daire',
        '11. Daire', '12. Daire', '13. Daire', '14. Daire', '15. Daire',
        'ƒ∞dari Dava Daireleri Kurulu', 'Vergi Dava Daireleri Kurulu'
    ],
    'SAYISTAY': [
        '1. Daire', '2. Daire', '3. Daire', '4. Daire', '5. Daire',
        '6. Daire', '7. Daire', 'Genel Kurul'
    ],
    'ANAYASA MAHKEMESI': [
        'Birinci B√∂l√ºm', 'ƒ∞kinci B√∂l√ºm', 'Genel Kurul'
    ]
};

// Store the selected chamber value from server
let selectedChamber = '{{ chamber|escapejs }}';

document.getElementById('court_type').addEventListener('change', function() {
    const courtType = this.value;
    const chamberSelect = document.getElementById('chamber');
    
    chamberSelect.innerHTML = '<option value="">T√ºm√º</option>';
    
    if (courtType && chamberData[courtType]) {
        chamberData[courtType].forEach(function(chamber) {
            const option = document.createElement('option');
            option.value = chamber;
            option.textContent = chamber;
            if (selectedChamber === chamber) {
                option.selected = true;
            }
            chamberSelect.appendChild(option);
        });
    }
});

document.addEventListener('DOMContentLoaded', function() {
    const courtTypeSelect = document.getElementById('court_type');
    if (courtTypeSelect.value) {
        courtTypeSelect.dispatchEvent(new Event('change'));
    }
});

document.getElementById('searchForm').addEventListener('submit', function() {
    document.getElementById('loadingOverlay').style.display = 'flex';
});

function clearFilters() {
    document.getElementById('searchForm').reset();
    document.getElementById('chamber').innerHTML = '<option value="">T√ºm√º</option>';
    selectedChamber = '';
    window.location.href = '{% url "judicial_decisions" %}';
}
</script>
{% endblock %}
EOF < /dev/null